<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>书籍购买下载页面</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        /* 书籍列表样式 */
        .book-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .book-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, border-color 0.3s;
        }
        .book-item:hover {
            transform: translateY(-5px);
            border-color: #007bff;
        }
        .book-item.selected {
            border-color: #007bff;
            background: #e8f4ff;
        }
        .book-item img {
            width: 100px;
            height: 150px;
            object-fit: cover;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .book-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .book-price {
            color: #e63946;
            font-weight: bold;
        }
        /* 付款区域样式 */
        .pay-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px dashed #ddd;
            border-radius: 8px;
        }
        .pay-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .pay-qrcode {
            text-align: center;
            margin-bottom: 15px;
        }
        .pay-qrcode img {
            width: 200px;
            height: 200px;
        }
        .pay-tips {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        /* 核验区域样式 */
        .check-section {
            margin-bottom: 30px;
        }
        .check-section input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .btn {
            padding: 12px 24px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        .btn:hover {
            background: #0056b3;
        }
        /* 下载区域样式 */
        .download-section {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        .download-section.success {
            display: block;
            background: #d4edda;
            color: #155724;
        }
        .download-link {
            color: #007bff;
            font-size: 18px;
            font-weight: bold;
            text-decoration: none;
            margin-top: 10px;
            display: inline-block;
        }
        .download-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>书籍购买下载中心</h1>

        <!-- 第一步：书籍列表（用户挑选） -->
        <div class="book-list">
            <div class="book-item" data-book-id="1" data-book-name="《Python入门到精通》" data-book-price="9.9" data-download-url="https://raw.githubusercontent.com/coolchobit/pay-txt-demo/refs/heads/main/python.txt">
                <img src="https://img9.doubanio.com/view/subject/s/public/s3366281.jpg" alt="Python入门到精通">
                <div class="book-name">《Python入门到精通》</div>
                <div class="book-price">¥9.9</div>
            </div>
            <div class="book-item" data-book-id="2" data-book-name="《JavaScript实战》" data-book-price="12.9" data-download-url="https://raw.githubusercontent.com/coolchobit/pay-txt-demo/refs/heads/main/js.txt">
                <img src="https://img2.doubanio.com/view/subject/s/public/s3490461.jpg" alt="JavaScript实战">
                <div class="book-name">《JavaScript实战》</div>
                <div class="book-price">¥12.9</div>
            </div>
            <div class="book-item" data-book-id="3" data-book-name="《SQL必知必会》" data-book-price="8.9" data-download-url="https://raw.githubusercontent.com/coolchobit/pay-txt-demo/refs/heads/main/sql.txt">
                <img src="https://img1.doubanio.com/view/subject/s/public/s1017471.jpg" alt="SQL必知必会">
                <div class="book-name">《SQL必知必会》</div>
                <div class="book-price">¥8.9</div>
            </div>
        </div>

        <!-- 第二步：付款区域 -->
        <div class="pay-section">
            <h3>付款说明（选中书籍后显示价格）</h3>
            <div id="selected-book-info">请先选择想要购买的书籍</div>
            <div class="pay-qrcode">
                <!-- 替换成你的收款码图片（建议上传到GitHub仓库，用raw地址） -->
                <img src="https://raw.githubusercontent.com/coolchobit/pay-txt-demo/refs/heads/main/pay-qrcode.jpg" alt="收款码">
            </div>
            <div class="pay-tips">
                1. 付款金额：<span id="pay-amount">0</span>元<br>
                2. 付款备注：<strong id="pay-remark-tips">请先选择书籍</strong>（例：Python入门到精通+1234）<br>
                3. 付款完成后，在下方输入备注信息进行核验
            </div>
        </div>

        <!-- 第三步：付款核验 -->
        <div class="check-section">
            <h3>付款核验</h3>
            <input type="text" id="pay-remark-input" placeholder="请输入你的付款备注（例：Python入门到精通+1234）">
            <button class="btn" id="check-pay-btn">核验付款并获取下载链接</button>
        </div>

        <!-- 第四步：下载区域 -->
        <div class="download-section" id="download-section">
            <h3>付款核验成功！</h3>
            <p>你购买的书籍：<span id="download-book-name"></span></p>
            <a href="" id="download-url" class="download-link" download>点击下载书籍文件</a>
        </div>
    </div>

    <script>
        // 全局变量：存储选中的书籍信息
        let selectedBook = null;

        // 1. 书籍选择逻辑
        const bookItems = document.querySelectorAll('.book-item');
        bookItems.forEach(item => {
            item.addEventListener('click', () => {
                // 取消其他书籍的选中状态
                bookItems.forEach(i => i.classList.remove('selected'));
                // 选中当前书籍
                item.classList.add('selected');
                // 存储选中书籍信息
                selectedBook = {
                    id: item.dataset.bookId,
                    name: item.dataset.bookName,
                    price: item.dataset.bookPrice,
                    downloadUrl: item.dataset.bookDownloadUrl
                };
                // 更新付款区域信息
                document.getElementById('selected-book-info').innerText = `你选中的书籍：${selectedBook.name}`;
                document.getElementById('pay-amount').innerText = selectedBook.price;
                document.getElementById('pay-remark-tips').innerText = `${selectedBook.name}+你的手机号后四位`;
            });
        });

        // 2. 付款核验逻辑（新手版：模拟核验，实际需你手动确认到账后放行）
        document.getElementById('check-pay-btn').addEventListener('click', () => {
            const payRemark = document.getElementById('pay-remark-input').value.trim();
            
            // 基础校验
            if (!selectedBook) {
                alert('请先选择想要购买的书籍！');
                return;
            }
            if (!payRemark) {
                alert('请输入付款备注信息！');
                return;
            }
            if (!payRemark.includes(selectedBook.name)) {
                alert('备注信息中未包含书籍名称，请核对！');
                return;
            }

            // 实际场景：你需要在后台核对付款备注+到账记录，这里先模拟核验通过
            // （后续可升级为：用户提交备注后，你在后台审核，审核通过后返回下载链接）
            alert('付款核验成功！即将显示下载链接~');
            
            // 显示下载区域
            const downloadSection = document.getElementById('download-section');
            downloadSection.classList.add('success');
            document.getElementById('download-book-name').innerText = selectedBook.name;
            document.getElementById('download-url').href = selectedBook.downloadUrl;
        });
    </script>
</body>
</html>
